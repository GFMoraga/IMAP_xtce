<?xml version='1.0' encoding='utf-8'?>
<xtce:SpaceSystem xmlns:xtce="http://www.omg.org/space" nsmap="{'xtce': 'http://www.omg.org/space'}" name="P_COD_HI_PHA">
	<xtce:Header date="2023-07-24" version="1.0" author="Gabriel Moraga" />
	<xtce:TelemetryMetaData>
		<xtce:ParameterTypeSet>
			<xtce:IntegerParameterType name="uint0" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="0" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint1" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="1" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint2" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="2" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint3" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="3" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint4" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="4" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint5" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="5" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint6" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="6" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint7" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="7" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint8" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="8" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint9" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="9" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint10" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="10" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint11" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="11" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint12" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="12" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint13" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="13" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint14" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="14" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint15" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="15" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint16" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="16" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint17" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="17" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint18" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="18" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint19" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="19" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint20" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="20" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint21" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="21" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint22" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="22" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint23" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="23" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint24" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="24" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint25" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="25" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint26" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="26" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint27" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="27" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint28" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="28" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint29" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="29" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint30" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="30" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint31" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="31" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
			<xtce:IntegerParameterType name="uint32" signed="false">
				<xtce:IntegerDataEncoding sizeInBits="32" encoding="unsigned" />
				<xtce:UnitSet />
			</xtce:IntegerParameterType>
		</xtce:ParameterTypeSet>
		<xtce:ParameterSet>
			<xtce:Parameter name="VERSION" parameterTypeRef="uint3">
				<xtce:LongDescription>CCSDS Packet Version Number (always 0)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="TYPE" parameterTypeRef="uint1">
				<xtce:LongDescription>CCSDS Packet Type Indicator (0=telemetry)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="SEC_HDR_FLG" parameterTypeRef="uint1">
				<xtce:LongDescription>CCSDS Packet Secondary Header Flag (always 1)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="PKT_APID" parameterTypeRef="uint11">
				<xtce:LongDescription>CCSDS Packet Application Process ID</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="SEG_FLGS" parameterTypeRef="uint2">
				<xtce:LongDescription>CCSDS Packet Grouping Flags (3=not part of group)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="SRC_SEQ_CTR" parameterTypeRef="uint14">
				<xtce:LongDescription>CCSDS Packet Sequence Count (increments with each new packet)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="PKT_LEN" parameterTypeRef="uint16">
				<xtce:LongDescription>CCSDS Packet Length (number of bytes after Packet length minus 1)</xtce:LongDescription>
			</xtce:Parameter>
		</xtce:ParameterSet>
		<xtce:ContainerSet>
			<xtce:SequenceContainer name="CCSDSPacket">
				<xtce:EntryList>
					<xtce:ParameterRefEntry parameterRef="VERSION" />
					<xtce:ParameterRefEntry parameterRef="TYPE" />
					<xtce:ParameterRefEntry parameterRef="SEC_HDR_FLG" />
					<xtce:ParameterRefEntry parameterRef="PKT_APID" />
					<xtce:ParameterRefEntry parameterRef="SEG_FLGS" />
					<xtce:ParameterRefEntry parameterRef="SRC_SEQ_CTR" />
					<xtce:ParameterRefEntry parameterRef="PKT_LEN" />
				</xtce:EntryList>
			</xtce:SequenceContainer>
		</xtce:ContainerSet>
		<xtce:ParameterSet>
			<xtce:Parameter name="Packet_Version" sequence="8" startByte="10" startBitInByte="0" startBit="80" lengthInBits="16" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="14.0">
				<xtce:LongDescription>Packet version - this will be incremented each time the format of the packet changesCOD_LO_PHA.</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Spin_Period" sequence="9" startByte="12" startBitInByte="0" startBit="96" lengthInBits="16" dataType="UINT" convertAs="ANALOG" units="Sec" source="-*-" mnemonicLength="11.0">
				<xtce:LongDescription>Spin period reported by the Spacecraft in the Time and Status message.  Reported period is the period that was active when the 16-spin acquisition cycle started.</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Acq_Start_Seconds" sequence="10" startByte="14" startBitInByte="0" startBit="112" lengthInBits="32" dataType="UINT" convertAs="NONE" units="Sec" source="-*-" mnemonicLength="17.0">
				<xtce:LongDescription>Full-seconds portion of the time at which the 16-spin cycle started</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Acq_Start_Subseconds" sequence="11" startByte="18" startBitInByte="0" startBit="144" lengthInBits="20" dataType="UINT" convertAs="NONE" units="uS" source="-*-" mnemonicLength="20.0">
				<xtce:LongDescription>Sub-seconds portion of the time at which the 16-spin cycle started</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Spare_1" sequence="12" startByte="20" startBitInByte="4" startBit="164" lengthInBits="12" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="7.0">
				<xtce:LongDescription>Spare for alignment</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Total_TCR_Count" sequence="13" startByte="22" startBitInByte="0" startBit="176" lengthInBits="32" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="15.0">
				<xtce:LongDescription>Total number of TCR events that occurred during the collection cycle</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Total_DCR_Count" sequence="14" startByte="26" startBitInByte="0" startBit="208" lengthInBits="32" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="15.0">
				<xtce:LongDescription>Total number of DCR events that occurred during the collection cycle</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Total_SSD_Count" sequence="15" startByte="30" startBitInByte="0" startBit="240" lengthInBits="32" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="15.0">
				<xtce:LongDescription>Total number of APD-Only events that occurred during the collection cycle</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Num_Events" sequence="16" startByte="34" startBitInByte="0" startBit="272" lengthInBits="32" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="10.0">
				<xtce:LongDescription>Number of events selected for downlink (i.e. number of events in the Event_Data array)</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Compressed" sequence="17" startByte="46" startBitInByte="0" startBit="368" lengthInBits="1" dataType="UINT" convertAs="STATE" units="DN" source="-*-" mnemonicLength="10.0">
				<xtce:LongDescription>Whether the event data is compressed.  If 1/Yes, Event_Data array is compressed using the Rice compression algorithm.</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Byte_Count" sequence="18" startByte="46" startBitInByte="1" startBit="369" lengthInBits="31" dataType="UINT" convertAs="NONE" units="DN" source="-*-" mnemonicLength="10.0">
				<xtce:LongDescription>Number of bytes in the Event_Data array.  If compressed, this value represents the length of the compressed data.</xtce:LongDescription>
			</xtce:Parameter>
			<xtce:Parameter name="Event_Data" sequence="19" startByte="50" startBitInByte="0" startBit="400" lengthInBits="276480" dataType="BYTE" convertAs="NONE" units="DN" source="-*-" mnemonicLength="10.0">
				<xtce:LongDescription>Optionally compressed array of Event Data

Format is TBD; some considerations/options:
- Full events have a lot of redundant data (e.g. will have many events with the same priority/spin/spin phase information).  How well does compression to deal with the redundancy?
- Could include mini-headers for each (priority,spin, spin-phase) group and strip the redundant data from the events
- Should events be tightly packed, or can we pad out to 64-bit word boundaries?  How well does compression compensate for the extra bits?

Each event consists of:
- 10-bit TOF            
-  9-bit SSD Energy
-  2-bit Energy Range
-  7-bit Spin Angle     
-  4-bit SSD Position   
-  4-bit Spin Number
-  2-bit PHA Type       

TBD: Events may be tightly packed, or may have spares added to keep each event byte-aligned.  In either case, there may be up to 1 byte of padding to keep the total size of the packet even.</xtce:LongDescription>
			</xtce:Parameter>
		</xtce:ParameterSet>
	</xtce:TelemetryMetaData>
</xtce:SpaceSystem>